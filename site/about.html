<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>zhufucdev</title>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <link rel="stylesheet" href="/shared/materialize.css">
    <link rel="stylesheet" href="/shared/material-icons.css">
    <link rel="stylesheet" href="/shared/style.css">
    <script src="/shared/jquery-3.4.1.js"></script>
    <script src="/shared/materialize.js"></script>
    <script src="/shared/repeater.js"></script>
    <script src="/shared/utility.js"></script>
    <script src="/shared/settings.js"></script>
    <script src="/shared/splash.js"></script>
</head>
<style>
    p i {
        vertical-align: middle;
        margin-right: 10px;
    }

    p span {
        vertical-align: middle;
        font-size: 16px;
        margin-right: 10px;
    }

    p img {
        vertical-align: middle;
        height: 24px;
        margin-right: 16px;
    }

    .level-2 {
        margin-left: 24px;
    }

    .family-nickname {
        float: right;
        font-style: italic;
        font-size: smaller;
    }

    .card {
        width: 100%;
    }
</style>
<body>
<main>
    <div class="navbar-fixed" style="height: 112px">
        <nav class="nav-extended">
            <div class="nav-wrapper">
                <a class="brand-logo">zhufucdev</a>
                <a class="hide-on-large-only left sidenav-trigger" style="margin-left: 12px" data-target="main-sidenav"
                   href="#"><i class="material-icons">menu</i></a>
            </div>
            <div class="nav-content">
                <ul class="tabs tabs-transparent" style="display: none">
                    <li class="tab"><a href="#basis">基本</a></li>
                    <li class="tab"><a href="#ability">能力</a></li>
                    <li class="tab"><a href="#events">经历</a></li>
                    <li class="tab experiment" id="experiment-tab" style="display: none"><a href="#experiment">实验性</a>
                    </li>
                </ul>
            </div>
        </nav>
    </div>
    <div style="width: 100%; display: none" class="deep-orange row" id="browser-not-supported">
        <span class="white-text col">您的浏览器似乎并不支持ECMAScript 2015或自定义标签的特性，故无法显示某些内容</span>
        <i class="material-icons white-text col right waves-effect" onclick="$(this).parent().hide()">close</i>
    </div>
    <ul class="sidenav sidenav-fixed" id="main-sidenav">
        <li>
            <div class="user-view">
                <div class="background blue"></div>
                <a><img src="shared/face.png" class="circle"></a>
                <a><span class="white-text name">zhufucdev</span> </a>
                <a><span class="white-text email">An individual developer for Java and C#</span> </a>
            </div>
        </li>
        <li><a class="waves-effect" href="/"><i class="material-icons">build</i>项目</a></li>
        <li><a class="waves-effect" href="blog"><i class="material-icons">collections_bookmark</i>博客</a></li>
        <li><a class="selected-item waves-effect"><i class="material-icons">error</i>关于</a></li>
        <li><a class="waves-effect" href="settings"><i class="material-icons">settings</i>设置</a></li>
    </ul>
    <div class="container" style="display: none">
        <div id="basis" class="row">
            <div class="col s12 m6">
                <div class="card">
                    <div class="card-content" style="vertical-align: middle">
                        <p><i class="material-icons green-text">account_circle</i><span>朱拂</span></p>
                        <p><i class="material-icons orange-text">location_on</i><span>中国 江苏省 常州市 横林镇</span></p>
                        <p><i class="material-icons purple-text">school</i><span>江苏省横林高级中学</span></p>
                        <p>
                            <i class="material-icons deep-orange-text">people</i><span>家庭成员</span>
                            <a id="btn-family-collection" class="right-absolute" href="#"><i
                                    class="material-icons black-text">expand_more</i></a>
                        </p>
                        <div class="family-collection level-2" style="display: none">
                            <i style="font-size: smaller">仅展示三代内直系亲属</i>
                            <p><i class="material-icons deep-orange-text">account_circle</i><span>朱拂</span></p>
                            <p><i class="material-icons deep-orange-text">account_circle</i><span>朱国忠</span><span
                                    class="family-nickname">父亲</span></p>
                            <p><i class="material-icons deep-orange-text">account_circle</i><span>刘玉莲</span><span
                                    class="family-nickname">母亲</span></p>
                            <p><i class="material-icons deep-orange-text">account_circle</i><span>朱焕庆</span><span
                                    class="family-nickname">祖父</span></p>
                            <p><i class="material-icons deep-orange-text">account_circle</i><span>吴金梅</span><span
                                    class="family-nickname">祖母</span></p>
                        </div>
                        <p><i class="material-icons blue-text">phone</i><span>136 8526 2029</span></p>
                        <p><i class="material-icons red-text">email</i><span>zhufuzhufu1@gmail.com</span></p>
                        <p><img src="/shared/external/QQ-logo.png"><span>1095291434</span></p>
                    </div>
                </div>
                <div class="card">
                    <div class="card-content">
                        <a class="right black-text waves-effect" id="voice-help"><i class="material-icons">help</i> </a>
                        <span class="card-title">口语</span>
                        <p>
                            <strong>汉语</strong>
                            <a class="waves-effect black-text right-absolute"
                               onclick="document.getElementById('chinese-player').play()"><i class="material-icons">play_arrow</i>
                            </a>
                            <audio src="/shared/voice/Ch.wav" id="chinese-player"></audio>
                        </p>
                        <p>
                            <strong>英语</strong>
                            <a class="waves-effect black-text right-absolute"
                               onclick="document.getElementById('english-player').play()"><i class="material-icons">play_arrow</i>
                            </a>
                            <audio src="/shared/voice/Eng.wav" id="english-player"></audio>
                        </p>
                    </div>
                </div>
                <div class="card" id="musical-card">
                    <div class="card-content">
                        <span class="card-title">音乐审美</span>
                        <a class="right black-text" id="btn-video-expand" style="line-height: 10px" href="#">
                            <i class="material-icons">expand_more</i>
                        </a>
                        <i>AlanWalker - Play</i>
                        <div id="expanding-video" style="display: none">
                            <video src="/shared/music/AlanWalker-Play.mp4" controls width="100%"></video>
                        </div>
                        <p>
                            <p class="red-text small">纯音乐</p>
                            <i>幻華楽 - 少女綺想曲 ~Dream Battle</i>
                            <audio src="/shared/music/Dream-Battle.mp3" controls style="width: 100%"></audio>
                        </p>
                        <p>
                            <i>Lensko - Infinite</i>
                            <audio src="/shared/music/Infinite.m4a" controls style="width: 100%"></audio>
                        </p>
                    </div>
                </div>
            </div>
            <div class="col s12 m6">
                <div class="card">
                    <div class="card-content">
                        <span class="card-title">
                            资源
                            <a class="waves-effect right black-text" id="resources-help"><i
                                    class="material-icons">help</i></a>
                        </span>
                        <p>
                            <i class="material-icons">desktop_mac</i><span>个人电脑</span>
                            <a id="btn-pc-collection" href="#" style="position: absolute; right: 10px"><i
                                    class="material-icons black-text">expand_more</i></a>
                        </p>
                        <div class="pc-collection level-2" style="display: none">
                            <p><i class="material-icons">memory</i><span>Intel Core™ i7-9700k</span></p>
                            <p><i class="material-icons">memory</i><span>Corsair 8GB×2 @ 3200MHz</span></p>
                            <p><i class="material-icons">memory</i><span>RX580 2408sp 4GB</span></p>
                            <p><i class="material-icons">tv</i><span>MINESU 21" 1080p & Hisense TV 1080p</span></p>
                            <p><i class="material-icons">keyboard</i><span>HP GK100</span></p>
                            <p><i class="material-icons">headset</i><span>Xiaomi TDSER02JY</span></p>
                        </div>
                        <p>
                            <i class="material-icons">phone_android</i><span>Redmi K30 5G</span>
                            <a id="btn-phone-collection" href="#" style="position: absolute; right: 10px"><i
                                    class="material-icons black-text">expand_more</i></a>
                        </p>
                        <div class="phone-collection level-2" style="display: none">
                            <p><i class="material-icons">memory</i><span>Snapdragon 765G</span></p>
                            <p><i class="material-icons">memory</i><span>6GB @ LPDDR4X 2133MHz</span></p>
                            <p><i class="material-icons">memory</i><span>Adreno™ 620</span></p>
                            <p><i class="material-icons">tv</i><span>6.67" 2400×1080px @ 120Hz</span></p>
                        </div>
                        <p>
                            <i class="material-icons">phone_iphone</i><span>iPhone 6</span>
                            <a id="btn-iphone-collection" href="#" style="position: absolute; right: 10px"><i
                                    class="material-icons black-text">expand_more</i></a>
                        </p>
                        <div class="iphone-collection level-2" style="display: none">
                            <p><i class="material-icons">memory</i><span>Apple A9</span></p>
                            <p><i class="material-icons">memory</i><span>1GB</span></p>
                            <p><i class="material-icons">memory</i><span>PowerVR GX6450</span></p>
                            <p><i class="material-icons">tv</i><span>4.7" 1334×710px</span></p>
                        </div>
                        <p>
                            <i class="material-icons">watch</i><span>小米手环4</span>
                            <a id="btn-band-collection" href="#" style="position: absolute; right: 10px"><i
                                    class="material-icons black-text">expand_more</i></a>
                        </p>
                        <div class="band-collection level-2" style="display: none">
                            <p><i class="material-icons">memory</i><span>512KB</span></p>
                            <p><i class="material-icons">tv</i><span>0.95" 240×120 AMOLED</span></p>
                            <p><i class="material-icons">bluetooth</i><span>BT5.0 BLE</span></p>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-content">
                        <span class="card-title">体貌</span>
                        <p><i class="material-icons blue-text">accessibility</i><span id="height">身高</span></p>
                        <div style="margin-left: 34px; font-size: 16px">
                            <p id="weight">体重</p>
                            <p>戴眼镜</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="ability" class="row no-search-bar">
            <a class="waves-effect right black-text" id="ability-help"><i class="material-icons">help</i> </a>
        </div>
        <div id="events">
            <a class="waves-effect right black-text" id="events-help"><i class="material-icons">help</i> </a>
        </div>
        <div id="experiment" class="experiment">
            <p class="orange-text">zhufucdev不能保证其中的信息绝对客观真实。</p>
            <div class="row">
                <div class="col s12 m6">
                    <div class="card waves-effect">
                        <div class="card-content" style="line-height: 40px" id="iq-help">
                            <i class="material-icons blue white-text circle-mdi circle">assistant</i>
                            <span style="margin-left: 10px">智商: 142</span>
                        </div>
                    </div>
                </div>
                <div class="col s12 m6">
                    <div class="card waves-effect">
                        <div class="card-content" style="line-height: 40px">
                            <a class="waves-effect right" id="attached-to-help">
                                <i class="material-icons black-text" style="vertical-align: middle">help</i>
                            </a>
                            <div id="card-attached-to">
                                <i class="material-icons red white-text circle-mdi circle">stars</i>
                                <span style="margin-left: 10px">喜欢的人</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>
<div class="modal" id="modal-helper">
    <div class="modal-content">
        <h4>帮助</h4>
        <p id="modal-helper-content"></p>
    </div>
    <div class="modal-footer">
        <a class="waves-effect btn-flat modal-close">确定</a>
    </div>
</div>
<div class="modal experiment" id="modal-attached-to">
    <div class="modal-content">
        <h4>猜测</h4>
        <div class="input-field">
            <input type="text" id="input-attached-to">
            <label for="input-attached-to">候选人姓名</label>
            <span class="helper-text red-text" id="not-attached-to" style="display: none">似乎并不</span>
        </div>
        <div class="input-field" id="input-field-number" style="display: none">
            <input type="number" id="input-number">
            <label for="input-number">您的电话号码</label>
        </div>
    </div>
    <div class="modal-footer">
        <a class="waves-effect btn-flat" id="attached-to-confirm">确定</a>
    </div>
</div>
<div class="modal modal-fixed-footer experiment" id="modal-speak-attached-to">
    <div class="modal-content">
        <h4>留言</h4>
        <p id="speak-attached-to"></p>
    </div>
    <div class="modal-footer">
        <a class="modal-close waves-effect btn-flat">关闭</a>
    </div>
</div>
<script>
    if (!checkBrowser()) {
        $('#browser-not-supported').show()
    }
    animateTitle('关于');
    checkWelcomeSplash();
    let tabs = document.querySelector('.tabs');
    tabs.style.display = null;
    M.AutoInit();
    if (!extendToolbarPages.includes(Settings.lastPage)) {
        let animator = new ObjectAnimator(0, tabs.clientHeight);
        animator.addUpdateListener(v => tabs.style.height = v + "px");
        animator.doOnEnd(() => tabs.style.height = null);
        animator.start();
    }
    let basis = document.querySelector('#basis');

    setTimeout(() => {
        for (let i = 0; i < basis.children.length; i++) {
            let item = basis.children.item(i);
            item.style.opacity = '0';
            setTimeout(() => {
                let animator = new ObjectAnimator(0, 1);
                animator.duration = 300;
                animator.addUpdateListener(v => item.style.opacity = v.toString());
                animator.start()
            }, i * 120)
        }
        document.querySelector('.container').style.display = null;
    }, 500);
    Settings.lastPage = "about";

    function expandable(btn, toBeExpanded) {
        btn.onclick = () => {
            let toShow = toBeExpanded.style.display === "none";

            let animator = (toShow ? new ObjectAnimator(0, 1) : new ObjectAnimator(1, 0));
            let collectionHeight = btn.parentElement.clientHeight * toBeExpanded.children.length;
            if (toShow) {
                toBeExpanded.style.height = toBeExpanded.style.opacity = '0';
            }
            toBeExpanded.style.display = null;
            animator.duration = 300;
            let html = document.querySelector('html'), originalScrollTop = html.scrollTop;
            animator.addUpdateListener(v => {
                btn.style.transform = "rotateX(" + 180 * v + "deg)";
                toBeExpanded.style.height = collectionHeight * v + "px";
                toBeExpanded.style.opacity = v.toString();
                html.scrollTop = originalScrollTop;
            });
            animator.doOnEnd(() => {
                toBeExpanded.style.height = toBeExpanded.style.opacity = null;
                if (!toShow) toBeExpanded.style.display = "none";
            });
            animator.start();
        }
    }

    expandable(document.getElementById('btn-family-collection'), document.querySelector('.family-collection'));
    expandable(document.getElementById('btn-pc-collection'), document.querySelector('.pc-collection'));
    expandable(document.getElementById('btn-iphone-collection'), document.querySelector('.iphone-collection'));
    expandable(document.getElementById('btn-phone-collection'), document.querySelector('.phone-collection'));
    expandable(document.getElementById('btn-band-collection'), document.querySelector('.band-collection'));
    expandable(document.getElementById('btn-video-expand'), document.getElementById('expanding-video'));
    /* Abilities */
    let ability = Repeat.init(document.getElementById('ability'));
    ability.model = `
<div style="display: flex" class="col s12 m6">
    <div style="align-self: flex-start; height: 40px; width: auto; margin: 5px">
        %icon
    </div>
    <div style="margin-left: 10px">
        <h5 style="margin: auto">%name</h5>
        <p>%description</p>
    </div>
</div>
        `;

    function getAbilityArgs(data) {
        return {
            "name": data.name,
            "description": data.description,
            "icon": data.icon.from === "src" ? '<img height="100%" src="' + data.icon.name + '"/>'
                : '<i class="material-icons" style="font-size: 40px">' + data.icon.name + '</i>'
        }
    }

    function getEventArgs(data) {
        let color, random = Math.floor(Math.random() * 10) % 5;
        switch (random) {
            case 0:
                color = 'red';
                break;
            case 1:
                color = 'blue';
                break;
            case 2:
                color = 'purple';
                break;
            case 3:
                color = 'green';
                break;
            case 4:
                color = 'orange';
                break;
        }
        return {
            icon: typeof data.icon === "string" ? data.icon : 'event',
            content: data.content,
            color: color
        }
    }

    /* Events */
    let events = Repeat.init(document.getElementById('events'));
    events.model = `
<div style="margin: 10px">
    <i class="material-icons circle white-text circle-mdi %color">%icon</i>
    <span style="vertical-align: middle">%content</span>
</div>
    `;
    events.categoryBuilder = (div) => {
        div.setAttribute('style', 'display: flex; flex-wrap: wrap');
        div.setAttribute('class', 'card card-content')
    };

    /* Download extra data */
    function useConstants(data) {
        let height = document.getElementById('height'), weight = document.getElementById('weight');
        setTimeout(() => {
            fadeSwitch(height, data.height[0] + data.height[1]);
            fadeSwitch(weight, data.weight[0] + data.weight[1]);
        }, 300);
        let abilityData = data["ability"];
        for (let category in abilityData) {
            if (abilityData.hasOwnProperty(category)) {
                let ab = abilityData[category];
                for (let i in ab) {
                    if (ab.hasOwnProperty(i) && typeof ab[i] === "object") {
                        ability.push(getAbilityArgs(ab[i]), category, true)
                    }
                }
            }
        }
        let eventsDataUnsorted = data["events"];
        let eventsData = {};
        Object.keys(eventsDataUnsorted).sort().forEach(key => {
            eventsData[key] = eventsDataUnsorted[key];
        });
        for (let year in eventsData) {
            if (eventsData.hasOwnProperty(year)) {
                let eventsInYear = eventsData[year];
                for (let i in eventsInYear) {
                    if (eventsInYear.hasOwnProperty(i) && typeof eventsInYear[i] === "object") {
                        events.push(getEventArgs(eventsInYear[i]), year, false)
                    }
                }
            }
        }
    }

    $.ajax({
        url: '/about?request=get&what=constants',
        dataType: 'json',
        success: useConstants
    });
    /* Helper */
    let textEle = document.getElementById('modal-helper-content');

    function attachHelperTo(id, content) {
        let ele = document.getElementById(id);
        ele.onclick = () => {
            textEle.innerHTML = content;
            $('#modal-helper').modal('open');
        }
    }

    attachHelperTo('ability-help', '此处仅罗列正常人在十岁后自然学习所不能获得的能力。包括但不仅限。');
    attachHelperTo('resources-help', '二级菜单中的项目仅代表产品的一部分特性，以便快速了解。');
    attachHelperTo('events-help', `
<h5>是什么</h5>
展示有关zhufucdev的持续时长超过三天且对后来有影响的事件。包括但不仅限。
<h5>怎么看</h5>
从左往右、从上往下表示事件之间的相对时间从古至今。
    `);
    attachHelperTo('iq-help', '根据<a href="https://baike.baidu.com/item/%E6%96%AF%E5%9D%A6%E7%A6%8F-%E6%AF%94%E5%A5%88%E6%99%BA%E5%95%86%E6%B5%8B%E9%AA%8C/1768055?fr=aladdin">斯坦福-比奈测验' +
        '</a>，测于2017年5月。');
    attachHelperTo('voice-help', '音频由Redmi K30 5G自带麦克风录制。');
    /* Experiment Feature */
    let expTab = document.getElementById('experiment-tab');
    if (Settings.getPreference('experiment-feature').value) {
        expTab.style.display = null;
        /* Attached To */
        attachHelperTo('attached-to-help', '此项通常包括但不考虑与之有血缘关系的人。<br>zhufucdev并不想直接告诉您其具体内容，但您可以点击卡片来猜测，服务器会给予是或否的响应。此外，服务器不会记录猜测者的信息。');
        let attachedToCard = document.getElementById('card-attached-to');
        attachedToCard.onclick = () => {
            let modal = M.Modal.getInstance(document.getElementById('modal-attached-to')),
                attachedToInput = document.getElementById('input-attached-to'),
                helper = document.getElementById('not-attached-to'),
                numberField = document.getElementById('input-field-number'),
                numberInput = document.getElementById('input-number'),
                confirm = document.getElementById('attached-to-confirm');
            attachedToInput.value = numberInput.value = null;
            numberField.style.display = helper.style.display = 'none';
            attachedToInput.removeAttribute('disabled');
            M.updateTextFields();
            modal.open();

            function isNumberInputShown() {
                return numberField.style.display !== 'none'
            }

            function commonErrorHandler(e) {
                M.toast({html: '服务器拒绝了我们的请求：' + e.status});
            }

            function trial() {
                helper.style.display = 'none';
                $.ajax({
                    url: '/about?request=guessAttachedTo',
                    method: 'POST',
                    data: attachedToInput.value,
                    dataType: 'json',
                    success: function (r) {
                        if (r.result === 1) {
                            helper.textContent = "似乎并不";
                        } else if (r.result === 0) {
                            if (!isNumberInputShown())
                                fadeIn(numberField);
                            attachedToInput.setAttribute('disabled', '');
                            helper.textContent = r['period'];
                        }
                        helper.style.display = null;
                    },
                    error: commonErrorHandler
                })
            }

            function numberTrial() {
                if (numberInput.value) {
                    $.ajax({
                        url: '/about?request=guessNumber',
                        method: 'POST',
                        data: JSON.stringify({name: attachedToInput.value, number: numberInput.value}),
                        dataType: 'json',
                        success: function (r) {
                            if (r.result === 0) {
                                let modalSpeak = M.Modal.getInstance(document.getElementById('modal-speak-attached-to'));
                                let speak = document.getElementById('speak-attached-to');
                                speak.innerHTML = r['speak'];
                                modalSpeak.open();
                            }
                            modal.close();
                        },
                        error: commonErrorHandler
                    })
                } else {
                    modal.close()
                }
            }

            attachedToInput.onchange = trial;
            confirm.onclick = () => {
                if (isNumberInputShown()) {
                    numberTrial()
                }
            }
        }
    } else {
        document.querySelectorAll('.experiment').forEach(v => v.remove())
    }
</script>
</body>
</html>